"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var l=t[r];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}return function(t,r,l){return r&&e(t.prototype,r),l&&e(t,l),t}}(),BoardManager=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"tryGetCell",value:function(t,r,l){return e.isValidMove(t,r)?l.rows[t][r]:null}},{key:"isValidMove",value:function(e,t){return e>-1&&t>-1&&8>e&&8>t}},{key:"getFlatGameBoard",value:function(e){return Array.prototype.concat.apply([],e.rows)}},{key:"getEmptyCells",value:function(t){return e.getFlatGameBoard(t).filter(function(e){return 0===e.player})}},{key:"getPlayerCells",value:function(t,r){return e.getFlatGameBoard(r).filter(function(e){return e.player===t})}},{key:"getAdjacentCells",value:function(t,r){var l=e.tryGetCell(t.row-1,t.col,r),n=e.tryGetCell(t.row-1,t.col+1,r),a=e.tryGetCell(t.row-1,t.col-1,r),o=e.tryGetCell(t.row,t.col-1,r),u=e.tryGetCell(t.row,t.col+1,r),c=e.tryGetCell(t.row+1,t.col,r),i=e.tryGetCell(t.row+1,t.col+1,r),f=e.tryGetCell(t.row+1,t.col-1,r);return[l,n,a,o,u,c,i,f].filter(function(e){return null!==e})}},{key:"getOpenAdjacentCells",value:function(t,r){return e.getAdjacentCells(t,r).filter(function(e){return 0===e.player})}},{key:"resetTargetCells",value:function(t){e.getFlatGameBoard(t).forEach(function(e){return e.isTarget=!1})}},{key:"getInitialPlayer",value:function(e,t){return 3===e&&3===t||4===e&&4===t?1:3===e&&4===t||4===e&&3===t?2:0}},{key:"cellIsInitialTarget",value:function(e,t){return 2===e&&4===t||3===e&&5===t||4===e&&2===t||5===e&&3===t}},{key:"getInitialGameBoard",value:function(t){for(var r=new Gameboard(t),l=0;8>l;l++){for(var n=[],a=0;8>a;a++)n.push(new Cell(l,a,e.getInitialPlayer(l,a),e.cellIsInitialTarget(l,a)));r.rows.push(n)}return r}}]),e}();
"use strict";function _classCallCheck(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}var Cell=function s(t,a,i,c){_classCallCheck(this,s),this.row=t,this.col=a,this.player=i,this.isTarget=c,this.distance=0};
"use strict";function _classCallCheck(s,a){if(!(s instanceof a))throw new TypeError("Cannot call a class as a function")}var Gameboard=function s(a){_classCallCheck(this,s),this.rows=[],this.moves=[],this.players=a};
"use strict";function _classCallCheck(s,i){if(!(s instanceof i))throw new TypeError("Cannot call a class as a function")}var Move=function s(i,t,a,c,n){_classCallCheck(this,s),this.col=t,this.row=i,this.pointValue=a,this.player=c,this.isHighestScoring=n||!1};
"use strict";function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(r,n,t){return n&&e(r.prototype,n),t&&e(r,t),r}}(),ObservableEvent=function(){function e(){_classCallCheck(this,e),this.observers=[];for(var r=arguments.length,n=Array(r),t=0;r>t;t++)n[t]=arguments[t];n.length&&this.observers.concat(n)}return _createClass(e,[{key:"subscribe",value:function(e){this.observers.push(e)}},{key:"notify",value:function(e){this.observers.forEach(function(r){return r(e)})}}]),e}();
"use strict";function _classCallCheck(s,a){if(!(s instanceof a))throw new TypeError("Cannot call a class as a function")}var Player=function s(a){_classCallCheck(this,s),this.number=a,this.score=2};
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),Repository=function(){function e(){_classCallCheck(this,e),this.snapshots=[]}return _createClass(e,[{key:"recordMove",value:function(e){var t=this.getSnapshotPattern(e.gameBoard);console.log("Snapshot created: ",t),this.snapshots.push(t),e.snapShots=this.snapshots,console.log("Saving Data: ",e)}},{key:"getSnapshotPattern",value:function(e){return e.moves.reduce(function(e,t){return e+(t.col+"-"+t.row+"-"+t.player+"-"+(+t.wasHighestScoring||0)+",")},"")}}]),e}();
"use strict";function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),ScoreKeeper=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"getMoveCaptures",value:function(e,r,t,n){for(var a=[],o=-1;1>=o;o++)for(var i=-1;1>=i;i++)(0!==o||0!==i)&&(a=a.concat(this.doDirectionalSearch(e,r,o,i,t,n)));return a}},{key:"doDirectionalSearch",value:function(e,r,t,n,a,o){var i=BoardManager.tryGetCell(e+t,r+n,o);return null!==i?this.getDirectionalCaptures(i,t,n,a,o):[]}},{key:"getDirectionalCaptures",value:function(e,r,t,n,a){var o=[],i=this,l=function(e,l){for(var u=!0;u;){var c=e,s=l;u=!1;var f=BoardManager.tryGetCell(c,s,a);if(null===f)return[];var v=i.evaluateCell(f,n);if(v.isEmptyPosition)return[];{if(!v.isOpponentPosition)return o;o.push(f),e=c+r,l=s+t,u=!0,f=v=void 0}}};return l(e.row,e.col)}},{key:"evaluateCell",value:function(e,r){return{isEmptyPosition:0===e.player,isOpponentPosition:e.player!==r}}},{key:"recordMove",value:function(e,r,t,n,a){var o=this,i=this.getMoveCaptures(e,r,t,n),l=new Move(e,r,i.length,t,a);return i.length&&(n.moves.push(l),n.rows[e][r].player=t,i.forEach(function(e){e.distance=o.getHitDistance(l,e.col,e.row),e.player=t,e.isHit=!0}),console.log("Recording move: ",n)),i}},{key:"getHitDistance",value:function(e,r,t){var n=Math.abs(t-e.row),a=Math.abs(r-e.col);return n||a}},{key:"getScoreForPlayer",value:function(e,r){return BoardManager.getFlatGameBoard(r).filter(function(r){return r.player===e}).length}},{key:"getLeader",value:function(e,r){return e.score>r.score?1:r.score>e.score?2:0}},{key:"resetMoveRatings",value:function(e){return BoardManager.getFlatGameBoard(e).forEach(function(e){e.isHighestScoring=!1,e.isHit=!1,e.distance=0}),console.log("RESET GB: ",e),e}},{key:"setPlayerScores",value:function(r,t){r.forEach(function(r){return r.score=e.getScoreForPlayer(r.number,t)})}},{key:"getNextMovesForPlayer",value:function(r,t){var n=[],a=0,o=1===r?2:1;return BoardManager.resetTargetCells(t),BoardManager.getPlayerCells(o,t).forEach(function(o){BoardManager.getOpenAdjacentCells(o,t).forEach(function(o){var i=e.getMoveCaptures(o.row,o.col,r,t).length;a=a>i?a:i,i&&(o.isTarget=!0,o.pointValue=i,n.push(o))})}),n.forEach(function(e){return e.isHighestScoring=e.pointValue===a}),n}}]),e}();
"use strict";function _classCallCheck(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(a,o.key,o)}}return function(e,n,o){return n&&a(e.prototype,n),o&&a(e,o),e}}(),View=function(){function a(){_classCallCheck(this,a);var e=this;this.onMove=new ObservableEvent,this.onGameModeSelect=new ObservableEvent,$(function(){var a=$(".shell");$(".game-board").on("click",".cell",function(){var a=$(this);a.data("is-target")&&e.onMove.notify({row:+a.data("row-num"),col:+a.data("col-num"),isHighScoring:a.data("is-highest-scoring")})}),a.on("change",".show-move-marks",function(){this.checked?a.addClass("show-marks"):a.removeClass("show-marks")}).on("change",".show-logging",function(){this.checked?a.addClass("show-logging"):a.removeClass("show-logging")}).on("click",".game-mode-button",function(){var a=$(this).data("game-mode"),n=$(".choose-game-mode-view");n.addClass("animated-fast fadeOut"),setTimeout(function(){n.hide(),$(".game-view").show().addClass("animated-fast fadeIn"),e.onGameModeSelect.notify(a)},250)})})}return _createClass(a,[{key:"renderGameBoard",value:function(a,e){var n="";a.rows.forEach(function(a){a.forEach(function(a){var e=a.player?"<div class='player-game-piece'></div>":"";n+="<div class='cell'\n                              data-distance=\""+a.distance+'"\n                              data-is-target="'+a.isTarget+'"\n                              data-is-highest-scoring="'+a.isHighestScoring+'"\n                              data-player-num="'+a.player+"\"\n                              data-row-num='"+a.row+"'\n                              data-col-num='"+a.col+"'>"+e+"</div>"})}),$(".game-board").html(n),e.map(function(a){return a.distance}).filter(function(a,e,n){return n.indexOf(a)===e}).sort(function(a,e){return a-e}).forEach(function(a,e){setTimeout(function(){$("[data-distance='"+a+"'] .player-game-piece").addClass("animated-fast pulse")},75*e)})}},{key:"updateScoreBoards",value:function(a,e){a.forEach(function(a){var n=$(".score-board.player-"+a.number);n.find(".score").html(a.score),a.number===e?n.addClass("active"):n.removeClass("active")})}},{key:"announceWinner",value:function(a){var e;e=a?$(".score-board.player-"+a):$(".score-board"),e.addClass("active animated tada")}},{key:"updateLogging",value:function(a){var e=$(".logging-container");e.append(a),e.animate({scrollTop:e.prop("scrollHeight")},975)}}]),a}();
"use strict";function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,n){for(var o=0;o<n.length;o++){var t=n[o];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(n,o,t){return o&&e(n.prototype,o),t&&e(n,t),n}}(),Othello=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"sortMovesByPointValue",value:function(e){return e.map(function(e){return e}).sort(function(e,n){return n.pointValue-e.pointValue})}},{key:"isCorner",value:function(e){var n=[[0,0],[0,7],[7,0],[7,7]];return n.some(function(n){return n[0]===e.col&&n[1]===e.row})}},{key:"isEdge",value:function(e){return 0===e.row||7===e.row||0===e.col||7===e.col}},{key:"getHighestScoringMove",value:function(n){return e.sortMovesByPointValue(n)[0]}},{key:"makeMove",value:function(n){var o="",t=n.filter(function(n){return e.isCorner(n)}),r=n.filter(function(n){return e.isEdge(n)}),a={};return t.length?(a=e.getHighestScoringMove(t),o="corner position available"):r.length?(a=e.getHighestScoringMove(r),o="edge position available"):(a=e.getHighestScoringMove(n),o="highest point value"),{row:a.row,col:a.col,basedOn:o}}},{key:"makeRandomMove",value:function(n){var o=e.getRandomIndex(n.length),t=n[o];return{row:t.row,col:t.col,basedOn:"random selection"}}},{key:"getRandomIndex",value:function(e){return Math.floor(Math.random()*e)}}]),e}();
"use strict";!function(){function e(e){var r=ScoreKeeper.recordMove(e.row,e.col,c.number,m,e.isHighScoring);if(r.length){var l=ScoreKeeper.getNextMovesForPlayer(i.number,m);ScoreKeeper.setPlayerScores(s,m),b.renderGameBoard(m,r),ScoreKeeper.resetMoveRatings(m),l.length&&(console.log("It's now player "+i.number+"'s turn"),o()&&a(l)),b.updateScoreBoards(s,c.number),t()}else{var u=ScoreKeeper.getNextMovesForPlayer(c.number,m);b.renderGameBoard(m,r),u.length?(console.log("It's still player "+c.number+"'s turn"),o()&&a(u),b.updateScoreBoards(s,c.number)):n()}}function r(e){if(g=d[e],b.renderGameBoard(m,[]),b.updateScoreBoards(s,c.number),g===d.learning){var r=ScoreKeeper.getNextMovesForPlayer(c.number,m);a(r)}}function n(){var e=ScoreKeeper.getLeader(l,u);b.announceWinner(e)}function o(){return g===d.learning||g===d.singlePlayer&&i.number===u.number}function a(r){setTimeout(function(){var n=i.number===l.number?Othello.makeRandomMove(r):Othello.makeMove(r);e(n)},1e3)}function t(){c.number===l.number?(c=u,i=l):(c=l,i=u)}var l=new Player(1),u=new Player(2),c=l,i=u,s=[l,u],m=BoardManager.getInitialGameBoard(s),b=new View,g=null,d={singlePlayer:Symbol(),twoPlayer:Symbol(),learning:Symbol()};b.onMove.subscribe(e),b.onGameModeSelect.subscribe(r)}();
//# sourceMappingURL=app.js.map
