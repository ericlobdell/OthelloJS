"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var l=t[r];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}return function(t,r,l){return r&&e(t.prototype,r),l&&e(t,l),t}}(),BoardManager=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"tryGetCell",value:function(e,t,r){return this.isValidMove(e,t)?r.rows[e][t]:null}},{key:"isValidMove",value:function(e,t){return e>-1&&t>-1&&8>e&&8>t}},{key:"getFlatGameBoard",value:function(e){return Array.prototype.concat.apply([],e.rows)}},{key:"getEmptyCells",value:function(e){return this.getFlatGameBoard(e).filter(function(e){return 0===e.player})}},{key:"getPlayerCells",value:function(e,t){return this.getFlatGameBoard(t).filter(function(t){return t.player===e})}},{key:"getOpenAdjacentCells",value:function(e,t){var r=this.tryGetCell(e.row-1,e.col,t),l=this.tryGetCell(e.row-1,e.col+1,t),n=this.tryGetCell(e.row-1,e.col-1,t),a=this.tryGetCell(e.row,e.col-1,t),o=this.tryGetCell(e.row,e.col+1,t),u=this.tryGetCell(e.row+1,e.col,t),i=this.tryGetCell(e.row+1,e.col+1,t),c=this.tryGetCell(e.row+1,e.col-1,t);return[r,l,n,a,o,u,i,c].filter(function(e){return null!==e&&0===e.player})}},{key:"resetTargetCells",value:function(e){this.getFlatGameBoard(e).forEach(function(e){return e.isTarget=!1})}},{key:"getInitialGameboard",value:function(){for(var e=new Gameboard,t=function(e,t){return 3===e&&3===t||4===e&&4===t?1:3===e&&4===t||4===e&&3===t?2:0},r=function(e,t){return 2===e&&4===t||3===e&&5===t||4===e&&2===t||5===e&&3===t},l=0;8>l;l++){for(var n=[],a=0;8>a;a++)n.push(new Cell(l,a,t(l,a),r(l,a)));e.rows.push(n)}return e}}]),e}();
"use strict";function _classCallCheck(s,a){if(!(s instanceof a))throw new TypeError("Cannot call a class as a function")}var Cell=function s(a,t,l,c){_classCallCheck(this,s),this.row=a,this.col=t,this.player=l,this.isTarget=c};
"use strict";function _classCallCheck(s,a){if(!(s instanceof a))throw new TypeError("Cannot call a class as a function")}var Gameboard=function s(a){_classCallCheck(this,s),this.rows=[],this.moves=[],this.players=a};
"use strict";function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var Move=function t(i,s,a,c,h){_classCallCheck(this,t),this.col=s,this.row=i,this.pointValue=a,this.player=c,this.time=0,this.timeInMatch=0,this.distance=0,this.highestScoring=h};
"use strict";function _classCallCheck(s,a){if(!(s instanceof a))throw new TypeError("Cannot call a class as a function")}var Player=function s(a){_classCallCheck(this,s),this.number=a,this.score=2,this.moves=[]};
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),Repository=function(){function e(){_classCallCheck(this,e),this.snapshots=[]}return _createClass(e,[{key:"recordMove",value:function(e){var t=this.getSnapshotPattern(e.gameBoard);console.log("Snapshot created: ",t),this.snapshots.push(t),e.snapShots=this.snapshots,console.log("Saving Data: ",e)}},{key:"getSnapshotPattern",value:function(e){return e.moves.reduce(function(e,t){return e+(t.x+"-"+t.y+"-"+t.player+"-"+(+t.wasHighestScoring||0)+",")},"")}}]),e}();
"use strict";function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,r){for(var a=0;a<r.length;a++){var t=r[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(r,a,t){return a&&e(r.prototype,a),t&&e(r,t),r}}(),ScoreKeeper=function(){function e(r){_classCallCheck(this,e),this.boardManager=r}return _createClass(e,[{key:"setScoreForMove",value:function(e,r,a,t){for(var n=[],o=-1;1>=o;o++)for(var l=-1;1>=l;l++)(0!==o||0!==l)&&(n=n.concat(this.searchAt(e,r,o,l,a,t)));return n}},{key:"setHitDistance",value:function(e,r,a){e.distance=Math.abs(r-e.col)+Math.abs(a-e.row)}},{key:"calculatePoints",value:function(e,r,a,t,n){function o(e,o){for(var c=!0;c;){var s=e,u=o;f=v=void 0,c=!1;var f=i.boardManager.tryGetCell(s,u,n);if(null===f)return[];var v=i.checkCell(f,t);if(!v.isValidMove||v.isEmpty)return[];if(!v.isPoint)return l;f.player=t,l.push(f),e=s+r,o=u+a,c=!0}}var l=[],i=this;return o(e.row,e.col)}},{key:"checkCell",value:function(e,r){var a=this.boardManager.isValidMove(e.row,e.col),t=a?0===e.player:!1,n=a?e.player!==r&&!t:!1;return{isValidMove:a,isEmpty:t,isPoint:n}}},{key:"getScoreForPlayer",value:function(e,r){return this.boardManager.getFlatGameBoard(r).reduce(function(r,a){return a.player===e&&r++,r},0)}},{key:"resetMoveScoreRatings",value:function(e){return this.boardManager.getFlatGameBoard(e).forEach(function(e){return e.isHighestScoring=!1}),e}},{key:"searchAt",value:function(e,r,a,t,n,o){var l=this.boardManager.tryGetCell(e+a,r+t,o);return null!==l?this.calculatePoints(l,a,t,n,o):[]}},{key:"nextMovesForPlayer",value:function(e,r){var a=this,t=[],n=1===e?2:1;a.boardManager.resetTargetCells(r);var o=a.boardManager.getPlayerCells(n,r);return o.forEach(function(n){var o=a.boardManager.getOpenAdjacentCells(n,r);console.log(o),o.forEach(function(n){var o=a.setScoreForMove(n.row,n.col,e,r);o.length&&(n.isTarget=!0,n.pointValue=o.length,console.log("Adding - ",n),t.push(n))})}),t}}]),e}();
"use strict";var _slicedToArray=function(){function r(r,e){var t=[],o=!0,a=!1,n=void 0;try{for(var l,i=r[Symbol.iterator]();!(o=(l=i.next()).done)&&(t.push(l.value),!e||t.length!==e);o=!0);}catch(c){a=!0,n=c}finally{try{!o&&i["return"]&&i["return"]()}finally{if(a)throw n}}return t}return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return r(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();!function(){function r(){var r=s.getFlatGameBoard(v);r.forEach(function(r){r.isTarget=!1});var e=r.filter(function(r){return r.player===c.number}),o=[];return e.forEach(function(r){var e=s.tryGetCell(r.row,r.col-1,v);t(e,o);var a=s.tryGetCell(r.row+1,r.col-1,v);t(a,o);var n=s.tryGetCell(r.row-1,r.col-1,v);t(n,o);var l=s.tryGetCell(r.row-1,r.col,v);t(l,o);var i=s.tryGetCell(r.row+1,r.col,v);t(i,o);var c=s.tryGetCell(r.row,r.col+1,v);t(c,o);var u=s.tryGetCell(r.row+1,r.col+1,v);t(u,o);var f=s.tryGetCell(r.row-1,r.col+1,v);t(f,o)}),o}function e(r){var e=n(),t=_slicedToArray(e,2),o=(t[0],t[1]),a=f.setScoreForMove(r.row,r.col,o,v),l=a.length,i=0===r.player&&l>0;return[i,l]}function t(r,t){if(null!==r){var o=e(r),a=_slicedToArray(o,2),n=a[0],l=a[1];n&&(r.isTarget=!0,r.pointValue=l,-1===t.indexOf(r)&&t.push(r))}}function o(r){var e=1===r?0:1;c=u[e]}function a(r){r.forEach(function(r){var e=$(".player-"+r.number);r.score=f.getScoreForPlayer(r.number,v),$(".player-"+r.number+" .score").html(r.score),$(".player-"+r.number+" .moves").html(r.moves.length),r.number===c.number?e.addClass("active"):e.removeClass("active")})}function n(){var r=1===c.number?1:0;return[c.number,u[r].number]}var l=new Player(1),i=new Player(2),c=l,u=[l,i],s=new BoardManager,v=s.getInitialGameboard(),f=new ScoreKeeper(s),y=function(){var r="";v.rows.forEach(function(e,t){e.forEach(function(e,o){r+="<div class='cell' title='"+e.distance+"' data-target=\""+e.isTarget+'" data-is-highest-scoring-move="'+e.isHighestScoring+'" data-player-num="'+e.player+"\" data-row-num='"+t+"' data-col-num='"+o+"'>"+e.player+"</div>"})}),$(".game-board").html(r)};$(".game-board").on("click",".cell",function(){var e=$(this),t=e.data("target");if(t){var l=+e.data("row-num"),i=+e.data("col-num"),c=e.data("is-highest-scoring-move"),s=n(),m=_slicedToArray(s,2),d=m[0],g=m[1],h=f.setScoreForMove(i,l,d,v),w=h.length;if(0!==w){var p=new Move(l,i,w,d,c);v.moves.push(p),h.forEach(function(r){return r.player=d});var b=r();console.log("Potential Next Moves: ",b);var C=b.sort(function(r,e){return e.pointValue-r.pointValue})[0];C.isHighestScoring=!0,o(g),console.log("Rendering gameboard"),y(),a(u),f.resetMoveScoreRatings(v),b?console.log("It's now player %d's turn",g):console.log("No next moves for player %d",g)}}}),y(),a(u)}();
//# sourceMappingURL=app.js.map
