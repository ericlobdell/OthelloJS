"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var l=t[r];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}return function(t,r,l){return r&&e(t.prototype,r),l&&e(t,l),t}}(),BoardManager=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"tryGetCell",value:function(e,t,r){return this.isValidMove(e,t)?r.rows[e][t]:null}},{key:"isValidMove",value:function(e,t){return e>-1&&t>-1&&8>e&&8>t}},{key:"getFlatGameBoard",value:function(e){return Array.prototype.concat.apply([],e.rows)}},{key:"getEmptyCells",value:function(e){return this.getFlatGameBoard(e).filter(function(e){return 0===e.player})}},{key:"getPlayerCells",value:function(e,t){return this.getFlatGameBoard(t).filter(function(t){return t.player===e})}},{key:"getAdjacentCells",value:function(e,t){var r=this.tryGetCell(e.row-1,e.col,t),l=this.tryGetCell(e.row-1,e.col+1,t),n=this.tryGetCell(e.row-1,e.col-1,t),a=this.tryGetCell(e.row,e.col-1,t),i=this.tryGetCell(e.row,e.col+1,t),o=this.tryGetCell(e.row+1,e.col,t),u=this.tryGetCell(e.row+1,e.col+1,t),c=this.tryGetCell(e.row+1,e.col-1,t);return[r,l,n,a,i,o,u,c].filter(function(e){return null!==e})}},{key:"getOpenAdjacentCells",value:function(e,t){return this.getAdjacentCells(e,t).filter(function(e){return 0===e.player})}},{key:"resetTargetCells",value:function(e){this.getFlatGameBoard(e).forEach(function(e){return e.isTarget=!1})}},{key:"getiInitialPlayer",value:function(e,t){return 3===e&&3===t||4===e&&4===t?1:3===e&&4===t||4===e&&3===t?2:0}},{key:"cellIsInitialTarget",value:function(e,t){return 2===e&&4===t||3===e&&5===t||4===e&&2===t||5===e&&3===t}},{key:"getInitialGameboard",value:function(){for(var e=new Gameboard,t=0;8>t;t++){for(var r=[],l=0;8>l;l++)r.push(new Cell(t,l,this.getiInitialPlayer(t,l),this.cellIsInitialTarget(t,l)));e.rows.push(r)}return e}}]),e}();
"use strict";function _classCallCheck(s,a){if(!(s instanceof a))throw new TypeError("Cannot call a class as a function")}var Cell=function s(a,t,l,c){_classCallCheck(this,s),this.row=a,this.col=t,this.player=l,this.isTarget=c};
"use strict";function _classCallCheck(s,a){if(!(s instanceof a))throw new TypeError("Cannot call a class as a function")}var Gameboard=function s(a){_classCallCheck(this,s),this.rows=[],this.moves=[],this.players=a};
"use strict";function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var Move=function t(i,s,a,c,h){_classCallCheck(this,t),this.col=s,this.row=i,this.pointValue=a,this.player=c,this.time=0,this.timeInMatch=0,this.distance=0,this.highestScoring=h||!1};
"use strict";function _classCallCheck(s,a){if(!(s instanceof a))throw new TypeError("Cannot call a class as a function")}var Player=function s(a){_classCallCheck(this,s),this.number=a,this.score=2,this.moves=[]};
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),Repository=function(){function e(){_classCallCheck(this,e),this.snapshots=[]}return _createClass(e,[{key:"recordMove",value:function(e){var t=this.getSnapshotPattern(e.gameBoard);console.log("Snapshot created: ",t),this.snapshots.push(t),e.snapShots=this.snapshots,console.log("Saving Data: ",e)}},{key:"getSnapshotPattern",value:function(e){return e.moves.reduce(function(e,t){return e+(t.col+"-"+t.row+"-"+t.player+"-"+(+t.wasHighestScoring||0)+",")},"")}}]),e}();
"use strict";function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,r){for(var a=0;a<r.length;a++){var t=r[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(r,a,t){return a&&e(r.prototype,a),t&&e(r,t),r}}(),ScoreKeeper=function(){function e(r){_classCallCheck(this,e),this.boardManager=r}return _createClass(e,[{key:"setScoreForMove",value:function(e,r,a,t){for(var n=[],o=-1;1>=o;o++)for(var i=-1;1>=i;i++)(0!==o||0!==i)&&(n=n.concat(this.searchAt(e,r,o,i,a,t)));return n}},{key:"setHitDistance",value:function(e,r,a){e.distance=Math.abs(r-e.col)+Math.abs(a-e.row)}},{key:"calculatePoints",value:function(e,r,a,t,n){function o(e,o){for(var l=!0;l;){var u=e,s=o;f=v=void 0,l=!1;var f=c.boardManager.tryGetCell(u,s,n);if(null===f)return[];var v=c.checkCell(f,t);if(!v.isValidMove||v.isEmpty)return[];if(!v.isPoint)return i;i.push(f),e=u+r,o=s+a,l=!0}}var i=[],c=this;return o(e.row,e.col)}},{key:"checkCell",value:function(e,r){var a=this.boardManager.isValidMove(e.row,e.col),t=a?0===e.player:!1,n=a?e.player!==r&&!t:!1;return{isValidMove:a,isEmpty:t,isPoint:n}}},{key:"getScoreForPlayer",value:function(e,r){return this.boardManager.getFlatGameBoard(r).reduce(function(r,a){return a.player===e&&r++,r},0)}},{key:"getLeader",value:function(e,r){return e.score>r.score?1:r.score>e.score?2:0}},{key:"resetMoveScoreRatings",value:function(e){return this.boardManager.getFlatGameBoard(e).forEach(function(e){return e.isHighestScoring=!1}),e}},{key:"searchAt",value:function(e,r,a,t,n,o){var i=this.boardManager.tryGetCell(e+a,r+t,o);return null!==i?this.calculatePoints(i,a,t,n,o):[]}},{key:"nextMovesForPlayer",value:function(e,r){var a=this,t=[],n=0,o=1===e?2:1;return a.boardManager.resetTargetCells(r),a.boardManager.getPlayerCells(o,r).forEach(function(o){a.boardManager.getOpenAdjacentCells(o,r).forEach(function(o){var i=a.setScoreForMove(o.row,o.col,e,r).length;n=n>i?n:i,i&&(o.isTarget=!0,o.pointValue=i,t.push(o))})}),t.forEach(function(e){return e.isHighestScoring=e.pointValue===n}),t}}]),e}();
"use strict";function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(r,n,t){return n&&e(r.prototype,n),t&&e(r,t),r}}(),Othello=function(){function e(r){_classCallCheck(this,e),this.scoreKeeper=r}return _createClass(e,[{key:"sortMovesByPointValue",value:function(e){var r=e.map(function(e){return e});return r.sort(function(e,r){return r.pointValue-e.pointValue})}},{key:"sortMovesByCornerPosition",value:function(e){var r=this,n=e.map(function(e){return e});return n.sort(function(e,n){return r.isCorner(n)-r.isCorner(e)})}},{key:"getHighestScoringMove",value:function(e){return this.sortMovesByPointValue(e)[0]}},{key:"isCorner",value:function(e){var r=[[0,0],[0,7],[7,0],[7,7]];return r.some(function(r){return r[0]===e.col&&r[1]===e.row})}},{key:"isEdge",value:function(e){return 0===e.row||7===e.row||0===e.col||7===e.col}},{key:"makeMove",value:function(e){var r=this,n=this.sortMovesByPointValue(e)[0];e.filter(function(e){return r.isCorner(e)});return{row:n.row,col:n.col}}}]),e}();
"use strict";!function(){function e(e){1===e?(n=a,t=o):(n=o,t=a)}function r(e){e.forEach(function(e){var r=$(".player-"+e.number);$(".player-"+e.number+" .score").html(e.score),$(".player-"+e.number+" .moves").html(e.moves.length),e.number===n.number?r.addClass("active"):r.removeClass("active")})}var o=new Player(1),a=new Player(2),n=o,t=a,l=[o,a],c=new BoardManager,s=c.getInitialGameboard(),i=new ScoreKeeper(c),m=(new Othello(i),function(){var e="";s.rows.forEach(function(r,o){r.forEach(function(r,o){e+="<div class='cell' title='row: "+r.row+" col: "+r.col+" distance: "+r.distance+" isTarget: "+r.isTarget+"' data-target=\""+r.isTarget+'" data-is-highest-scoring-move="'+r.isHighestScoring+'" data-player-num="'+r.player+"\" data-row-num='"+r.row+"' data-col-num='"+r.col+"'>"+r.player+"</div>"})}),$(".game-board").html(e)});$(".game-board").on("click",".cell",function(){var l=$(this),c=l.data("target");if(c){var u=+l.data("row-num"),v=+l.data("col-num");console.log("Recording move at row "+u+" col "+v);var g=i.setScoreForMove(u,v,n.number,s);console.log("Hits: ",g);var d=g.length;if(0!==d){var b=new Move(u,v,d,n.number);console.log("Move: ",b),s.moves.push(b),s.rows[u][v].player=n.number,g.forEach(function(e){return e.player=n.number});var h=i.nextMovesForPlayer(t.number,s);m(),o.score=i.getScoreForPlayer(o.number,s),a.score=i.getScoreForPlayer(a.number,s),r([o,a]),i.resetMoveScoreRatings(s);var w=i.getLeader(o,a);h.length?(console.log("It's now player "+t.number+"'s turn"),e(n.number)):w?console.log("Game Over! Our winner is player "+w):console.log("Game Over! We have a tie!")}}}),m(),r(l)}();
//# sourceMappingURL=app.js.map
